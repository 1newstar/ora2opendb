## PPAS ORACLE 兼容性 之 序列（SEQUENCE）
---
序列（SEQUENCE）主要用来为多用户（SCHEMA）产生唯一的整数，最主要的应用：**为表自动生成主键/唯一键**.    
### 一、Oracle版本
1. **基本语法结构**

  ![CREATE SEQUENCE语法](https://docs.oracle.com/cd/E11882_01/server.112/e41084/img/create_sequence.gif)
  
  使用方式：**CURRVAL**：获取当前值；**NEXTVAL**：产生新值
```
sequence.CURRVAL  
sequence.NEXTVAL  
或者
schema.sequence.CURRVAL
schema.sequence.NEXTVAL 
或者
schema.sequence.CURRVAL@dblink
schema.sequence.NEXTVAL@dblink
```

2. **选项说明**
<table>
  <tr>
    <th width=20%, bgcolor=yellow >参数选项</th>
    <th width=80%, bgcolor=yellow>详细解释</th>
  </tr>
  <tr>
    <td bgcolor=#eeeeee style="text-align:center"> schema </td>
    <td> 指定序列属主，不指定，默认在当前用户下 </td>
  </tr>
  <tr>
    <td bgcolor=#00FF00 style="text-align:center"> sequence </td>
    <td> 序列名称，同一SCHEMA下，和其他对象不能同名 </td>
  <tr>
    <td bgcolor=rgb(0,10,0) style="text-align:center"> INCREMENT BY </td>
    <td> 序列增长的步长。默认值是 1/-1，取决于是正向序列 还是反向序列。值可以是任意正数/负数，但不能为0 </td>
  </tr>
  <tr>
    <td bgcolor=#00FF00) style="text-align:center"> START WITH </td>
    <td> 指定序列的起始值 </td>
  </tr>
   <tr>
    <td bgcolor=#eeeeee style="text-align:center"> MAXVALUE/NOMAXVALUE </td>
    <td> 指定序列的最大值。默认值：正向序列：10^28 -1; 反向序列：-1 </td>
  </tr>
  <tr>
    <td bgcolor=#00FF00 style="text-align:center"> MINVALUE/NOMINVALUE </td>
    <td> 指定序列的最小值。默认值：正向序列：1; 反向序列：-(10^27 -1) </td>
  <tr>
  </tr>
   <tr>
    <td bgcolor=#eeeeee style="text-align:center"> CYCLE/NOCYCLE </td>
    <td> 序列达到最大值或者最小值时，是否继续生成值(不然直接报错)。正向序列：最小值; 反向序列：最大值</td>
  </tr>
  <tr>
    <td bgcolor=#00FF00 style="text-align:center"> CACHE/NOCACHE </td>
    <td> 预先分配在内存中的缓存值,最小值为2。最大值满足公式：(CEIL (MAXVALUE - MINVALUE)) / ABS (INCREMENT)，RAC环境建议使用，以提高性能，2个选项默认都不执行，则以默认cache是20 </td>
  <tr>
  </tr>
   <tr>
    <td bgcolor=#eeeeee style="text-align:center"> ORDER/NOORDER </td>
    <td> 确保序列产生值的顺序性。 产生timestamps值时有用，主键时无用。RAC环境不建议使用，尤其是在并发高情况下。当使用exclusive模式时，总是有序的。要避免 NOCACHE+ORDER组合 </td>
  </tr>
</table>

3. **使用案例**
```
CREATE SEQUENCE scott.emp_seq
 START WITH 1000
 INCREMENT BY 1
 NOCACHE
 NOCYCLE;
 
SELECT scott.emp_seq.CURRVAL FROM DUAL;
 
SELECT scott.emp_seq.NEXTVAL FROM DUAL;
```

### 二、PostgreSQL版本
1. **基本语法结构**
```
CREATE [ TEMPORARY | TEMP ] SEQUENCE [ IF NOT EXISTS ] name [ INCREMENT [ BY ] increment ]
    [ MINVALUE minvalue | NO MINVALUE ] [ MAXVALUE maxvalue | NO MAXVALUE ]
    [ START [ WITH ] start ] [ CACHE cache ] [ [ NO ] CYCLE ]
    [ OWNED BY { table_name.column_name | NONE } ] 
```

2. **参数选型说明（<font color=#0099ff >仅列举于Oracle有差异的部分</font>）**
   TEMPORARY | TEMP: 临时序列创建于特殊的schema下,创建临时序列时，不可以指定schema名称，会话结束后自动删除序列，同时同名的永久序列不可见，除非加上schema名前缀。
   最小值：-2^63-1
   最大值：2^63-1
   如果CYCLE/NO CYCLE 不指定，默认是 NO CYCLE
   OWNED BY table_name.column_name|OWNED BY NONE：依赖于表或者列，列或者表删除，则序列自动删除,且表和序列必须在同一schema下。
  
   <font color=#0099ff>注意：序列值依赖于bigint算法：范围是 -9223372036854775808 ~ 9223372036854775807 </font>
   
3.    


### 三、PPAS版本
1. **基本语法结构**
```
CREATE SEQUENCE name [ INCREMENT BY increment ]
[ { NOMINVALUE | MINVALUE minvalue } ]
[ { NOMAXVALUE | MAXVALUE maxvalue } ]
[ START WITH start ] [ CACHE cache | NOCACHE ] [ CYCLE ]
```

2. 

### 四、Oracle ---> PPAS FAQ
1. 
